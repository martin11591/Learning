<html>
<style>
div{font-family:Trebuchet MS;font-size:10pt;font-weight:bold}
td{width:5px;height:5px;text-align:center;margin:0px;cursor:default}
td.kolory{width:20px;height:10px}
hr{width:700px;text-align:left}
img{position:relative;left:-5px;top:-18px}
</style>
<div id="pole_tablicy">Proszê czekaæ...</div>
<div id="pole_kolorow" style="display:none">
Lewy klawisz myszki<br>
<hr><img src="..\Obrazy\Slide.ico" id="ltlor"></img><br>
<hr><img src="..\Obrazy\Slide.ico" id="ltlog"></img><br>
<hr><img src="..\Obrazy\Slide.ico" id="ltlob"></img><br>
<table border=1><td id="lmbc" style="width:50px;height:50px"></td></table>
Prawy klawisz myszki<br>
<hr><img src="..\Obrazy\Slide.ico" id="ptlor"></img><br>
<hr><img src="..\Obrazy\Slide.ico" id="ptlog"></img><br>
<hr><img src="..\Obrazy\Slide.ico" id="ptlob"></img><br>
<table border=1><td id="rmbc" style="width:50px;height:50px"></td></table>
</div>
<script src="skrypty\hex_1.js"></script>
<script>
document.all.pole_tablicy.oncontextmenu=anuluj;
document.all.pole_kolorow.oncontextmenu=anuluj;
document.all.pole_tablicy.onmousemove=myszStat;
document.all.pole_tablicy.onmouseout=czysc_stat;
document.all.ltlor.ondragstart=ltlorscroll;
document.all.ltlog.ondragstart=ltlogscroll;
document.all.ltlob.ondragstart=ltlobscroll;
document.all.ptlor.ondragstart=ptlorscroll;
document.all.ptlog.ondragstart=ptlogscroll;
document.all.ptlob.ondragstart=ptlobscroll;
document.ondragstart=anuluj;
ltlocr=ltlocg=ltlocb=0;
ptlocr=ptlocg=ptlocb=255;
setcolors1();
mk=143;
mw=60;
lewyktlo=document.fgColor;
prawyktlo=document.bgColor;
utworz_tablice(mk,mw);
function pozycja() {
x=event.clientX-17;
if(x<-5){x=-5}
if(x>694){x=694}
}
function ltlorscroll() {
pozycja();
document.all.ltlor.style.left=x;
ltlocr=Math.round((x+5)*255/699);
setcolors();
return false;
}
function ltlogscroll() {
pozycja();
document.all.ltlog.style.left=x;
ltlocg=Math.round((x+5)*255/699);
setcolors();
return false;
}
function ltlobscroll() {
pozycja();
document.all.ltlob.style.left=x;
ltlocb=Math.round((x+5)*255/699);
setcolors();
return false;
}
function ptlorscroll() {
pozycja();
document.all.ptlor.style.left=x;
ptlocr=Math.round((x+5)*255/699);
setcolors();
return false;
}
function ptlogscroll() {
pozycja();
document.all.ptlog.style.left=x;
ptlocg=Math.round((x+5)*255/699);
setcolors();
return false;
}
function ptlobscroll() {
pozycja();
document.all.ptlob.style.left=x;
ptlocb=Math.round((x+5)*255/699);
setcolors();
return false;
}
function setcolors1() {
with(document.all){
ltlor.style.left=694*ltlocr/255;
ltlog.style.left=694*ltlocg/255;
ltlob.style.left=694*ltlocb/255;
ptlor.style.left=694*ptlocr/255;
ptlog.style.left=694*ptlocg/255;
ptlob.style.left=694*ptlocb/255;
}
setcolors();
}
function setcolors() {
lewyktlo="#"+licz(ltlocr)+licz(ltlocg)+licz(ltlocb);
prawyktlo="#"+licz(ptlocr)+licz(ptlocg)+licz(ptlocb);
document.all.lmbc.style.backgroundColor=lewyktlo;
document.all.rmbc.style.backgroundColor=prawyktlo;
}
function myszStat() {mysz=event.button}
function zaznacz(tablica,kolumna,wiersz,zazn) {
tablica=document.getElementById(tablica);
if (mysz==1) {zazn=2}
if (mysz==2) {zazn=3}
window.status=kolumna+","+wiersz;
if (zazn==0) {
with (tablica.rows[wiersz].cells[kolumna].style) {
backgroundColor=ktlo[wiersz][kolumna];
}
}
if (zazn==1) {
with (tablica.rows[wiersz].cells[kolumna].style) {
backgroundColor="Highlight";
}
}
if (zazn==2) {
with (tablica.rows[wiersz].cells[kolumna].style) {
backgroundColor=lewyktlo;
}
ktlo[wiersz][kolumna]=lewyktlo;
}
if (zazn==3) {
with (tablica.rows[wiersz].cells[kolumna].style) {
backgroundColor=prawyktlo;
}
ktlo[wiersz][kolumna]=prawyktlo;
}
}
function utworz_tablice(wk,ww) {
this.tabl="<table border=1 id=\"tablica1\" cellspacing=0 cellpadding=0 bordercolor=black bordercolordark=black>";
this.k=0;
this.w=0;
this.wk=wk;
this.ww=ww;
ktlo=new Array(ww);
ktlo[0]=new Array(wk);
liczbaPol=ww*wk+wk-2;
aa=new Date();
dokonca=liczbaPol*182/8540;
ttstart=Math.round(aa.getTime()/1000);
tstart=ttstart+dokonca;
aStart=new Date().getTime();
tworz();
}
function tworz() {
aktualnePole=w*wk+k;
aa=new Date().getTime();
elapsed=aa-aStart;
estimated=liczbaPol*elapsed/aktualnePole;
remaining=estimated-elapsed;
min=Math.floor(remaining/1000/60);
sek=Math.floor(remaining/1000-min*60);
if (sek<10) sek="0"+sek;
perc=parseInt(aktualnePole*100/liczbaPol);
dokonca=parseInt((liczbaPol-aktualnePole/2)*182/8540);
tstart=ttstart+dokonca;
pole_tablicy.innerText="Proszê czekaæ... "+perc+"% ("+(aktualnePole)+" pól zrobionych na "+liczbaPol+")\nDo skoñczenia zosta³o oko³o "+min+":"+sek+".";
ktlo[w][k]="#FFFFFF";
if (w>ww) {tabl+="</tr>"}
if (k==0) {tabl+="<tr>"}
tabl+="<td onmouseover=\"zaznacz(\'tablica1\',"+k+","+w+",1)\" onmouseout=\"zaznacz(\'tablica1\',"+k+","+w+",0)\" onclick=\"zaznacz(\'tablica1\',"+k+","+w+",2)\" oncontextmenu=\"zaznacz(\'tablica1\',"+k+","+w+",3)\"></td>";
k+=1;
if (k>wk) {k=0;w+=1;ktlo[w]=new Array(wk)}
if (k==wk&&w==ww) {
tabl+="<td onmouseover=\"zaznacz(\'tablica1\',"+k+","+w+",1)\" onmouseout=\"zaznacz(\'tablica1\',"+k+","+w+",0)\" onclick=\"zaznacz(\'tablica1\',"+k+","+w+",2)\" oncontextmenu=\"zaznacz(\'tablica1\',"+k+","+w+",3)\"></td>";
if (w!=ww) {tabl+="</tr>"}
tabl+="</table>";
pole_tablicy.innerHTML=tabl;
document.all.pole_kolorow.style.display="block";
return;
}
setTimeout("tworz()",1);
}
function anuluj() {return false}
function czysc_stat() {window.status=""}
</script>