<html>
<head>
<style type=text/css>v\:* { behavior: url(#default#VML); }</style>
</head>
<body>
<table>
<tr>
<td><div id="graphdiv" class="graph"></div></td>
<td style="vertical-align:top">
<input id="ALFA" value=0 />,<input id="BETA" value=0 />,<input id="GAMA" value=0 /> - obrót wokó³ osi X, Y i Z<br>
<input id="VX" value=0 />,<input id="VY" value=250 />,<input id="VZ" value=0 /> - przesuniêcie poziome, wg³¹b obrazu i pionowe<br>
<input id="warK" value=10 /> - wspó³czynnik powiêkszenia<br>
<input id="warD" value=250 /> - odleg³oœæ obserwator-ekran<br>
<button onclick="bryla(FSAA)">Rysuj</button><br>
<button onclick="krokX-=1">Obracaj oœ X w lewo</button><button onclick="krokX+=1">Obracaj oœ X w prawo</button><br><button onclick="krokY-=1">Obracaj oœ Y w lewo</button><button onclick="krokY+=1">Obracaj oœ Y w prawo</button><br><button onclick="krokZ-=1">Obracaj oœ Z w lewo</button><button onclick="krokZ+=1">Obracaj oœ Z w prawo</button><br>
<button onclick="krokX=0">Zatrzymaj obracanie osi X</button><br><button onclick="krokY=0">Zatrzymaj obracanie osi Y</button><br><button onclick="krokZ=0">Zatrzymaj obracanie osi Z</button><br>
<input id="FSAACheckbox" type=checkbox checked onclick="FSAA=document.all.FSAACheckbox.checked?1:-1;bryla(FSAA)"/>Anti-Aliasing
</td>
</tr>
</table>
<span id="aa1">&nbsp;</span>
<script>
var rTimer;
FSAA=document.all.FSAACheckbox.checked?1:-1;
czysc(1);
draw();
cds=document.all.oknoRysowania.coordsize;
this.mK=Math.floor(parseFloat(cds));
this.mW=mK;
czysc();
document.all.ALFA.value=0;
document.all.BETA.value=0;
document.all.GAMA.value=0;
document.all.warK.value=35;
krokX=0;
krokY=0;
krokZ=0;
bryla(FSAA);
obracajOsie(krokX,krokY,krokZ);
function obracajOsie(krokX,krokY,krokZ) {
clearTimeout(rTimer);
alf=parseFloat(document.all.ALFA.value);
document.all.ALFA.value=(alf+krokX)%360;
bet=parseFloat(document.all.BETA.value);
document.all.BETA.value=(bet+krokY)%360;
gam=parseFloat(document.all.GAMA.value);
document.all.GAMA.value=(gam+krokZ)%360;
if(krokX!=0||krokY!=0||krokZ!=0) {bryla(FSAA)}
rTimer=setTimeout("obracajOsie(krokX,krokY,krokZ)",1);
}
function czysc(czyNieokreslono) {
txtS="<v:group id=\"oknoRysowania\" style=\"antialias:true; width=600px; height=600px\" coordsize=\"10000,10000\" coordorigin=\"0,0\">";
txtL=new Array();
txtK="<\/v:group>";
if (czyNieokreslono!=1) {line(0,0,mK,mW,"0px","white",-1)}
}
function draw() {document.all.graphdiv.innerHTML=txtS+txtL.join("")+txtK}
function line(x1,y1,x2,y2,sw,col,aa) {
if (aa==-1) {aa=""}
if (aa==0) {aa="style=\"antialias: false\" "} else {aa="style=\"antialias: true\" "}
txtL.push("<v:line "+aa+"from=\""+x1+","+y1+"\" to=\""+x2+","+y2+"\"><v:stroke weight=\""+sw+"\"; color=\""+col+"\";\/><\/v:line>");
}
function read(arg) {
arg=arg.split(",");
readI+=1;
return arg[readI-1];
}
function bryla(aa) {
readI=0;
czysc();
xyz=new Array();
xyz.push(0,0,0);
kraw="";
xyz.push(0,0,15,-15,0,35,0,0,100,15,0,35,0,-15,35,0,15,35);
kraw+="9,1,2,3,4,1,5,3,6,1,";
kraw+="5,2,6,4,5,2,";
xyz.push(0,0,-15,-15,0,-35,0,0,-100,15,0,-35,0,-15,-35,0,15,-35);
kraw+="9,7,8,9,10,7,11,9,12,7,";
kraw+="5,8,12,10,11,8,";
xyz.push(-15,0,0,-35,0,15,-100,0,0,-35,0,-15,-35,-15,0,-35,15,0);
kraw+="9,13,14,15,16,13,17,15,18,13,";
kraw+="5,14,18,16,17,14,";
xyz.push(15,0,0,35,0,15,100,0,0,35,0,-15,35,-15,0,35,15,0);
kraw+="9,19,20,21,22,19,23,21,24,19,";
kraw+="5,20,24,22,23,20,";
xyz.push(0,15,0,0,35,-15,0,100,0,0,35,15,-15,35,0,15,35,0);
kraw+="9,25,26,27,28,25,29,27,30,25,";
kraw+="5,26,30,28,29,26,";
xyz.push(0,-15,0,0,-35,15,0,-100,0,0,-35,-15,-15,-35,0,15,-35,0);
kraw+="9,31,32,33,34,31,35,33,36,31,";
kraw+="5,32,36,34,35,32,";
xyz.push(-10,0,0,0,0,10,10,0,0,0,0,-10,0,10,0,0,-10,0);
kraw+="9,37,38,39,40,37,41,39,42,37,";
kraw+="5,38,41,40,42,38";
ile2=14;
ile1=42;
var X=new Array();
var Y=new Array();
var Z=new Array();
ttxt="";
j=1;
for (var i=0; i<xyz.length; i+=3) {
X.push(xyz[i]);
Y.push(xyz[i+1]);
Z.push(xyz[i+2]);
if (i>0) {
ttxt+="  x["+j+"]:="+xyz[i]+";\n";
ttxt+="  y["+j+"]:="+xyz[i+1]+";\n";
ttxt+="  z["+j+"]:="+xyz[i+2]+";\n";
j+=1;
}
}
j1=1;
j2=1;
L=new Array();
K=new Array();
L.push(0);
K.push(0);
for (var i=1; i<=ile2; i++) {
L[i]=read(kraw);
ttxt+="  l["+j1+"]:="+L[i]+";\n";
K[i]=new Array();
K[i][0]=0;
for (var j=1; j<=L[i]; j++) {
K[i][j]=read(kraw);
ttxt+="  k["+j1+","+j2+"]:="+K[i][j]+";\n";
j2+=1;
}
j1+=1;
j2=1;
}
// document.all.aa1.innerText=ttxt;
this.X=X;
this.Y=Y;
this.Z=Z;
this.L=L;
this.K=K;
this.alfa=parseFloat(document.all.ALFA.value); // po³o¿enie
this.beta=parseFloat(document.all.BETA.value); // oka
this.gama=parseFloat(document.all.GAMA.value); // obserwatora

this.vx=parseFloat(document.all.VX.value); // punkt
this.vy=parseFloat(document.all.VY.value); // skierowania wzroku
this.vz=parseFloat(document.all.VZ.value); // obserwatora

this.k=parseFloat(document.all.warK.value); // wspó³czynnik powiêkszenia

this.d=parseFloat(document.all.warD.value); // odleg³oœæ obserwator-ekran
Kol=new Array();
Wiersz=new Array();
Kol.push(0);
Wiersz.push(0);
var x,y,z,x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4,x5,y5,z5,x6,y6,z6,u,v;
rysujBryle(mK,mW,aa);
}
function rysujBryle(mK,mW,aa) {
wspolczynniki();
function wspolczynniki() {
wa=alfa*Math.PI/180;
ca=Math.cos(wa);
sa=Math.sin(wa);
wb=beta*Math.PI/180;
cb=Math.cos(wb);
sb=Math.sin(wb);
wc=gama*Math.PI/180;
cc=Math.cos(wc);
sc=Math.sin(wc);
}
for (var i=1; i<=ile1; i++) {
x=parseFloat(X[i]);
y=parseFloat(Y[i]);
z=parseFloat(Z[i]);
odwzorowanie();
function odwzorowanie() {
x1=x;
y1=ca*y-sa*z;
z1=sa*y+ca*z;

x2=cb*x1-sb*z1;
y2=y1;
z2=sb*x1+cb*z1;

x3=cc*x2-sc*y2;
y3=sc*x2+cc*y2;
z3=z2;

x4=x3+vx;
y4=y3+vy;
z4=z3+vz;

u=-x4/y4*d;
v=-z4/y4*d;
kol=mK/2+k*u;
if (kol<0) {kol=0}
if (kol>mK) {kol=mK}
wiersz=mW/2-k*v;
if (wiersz<0) {wiersz=0}
if (wiersz>mW) {wiersz=mW}
}
Kol[i]=kol;
Wiersz[i]=wiersz;
}
for (var i=1; i<=ile2; i++) {
for (var j=1; j<=L[i]-1; j++) {
k1=Kol[K[i][j]];
w1=Wiersz[K[i][j]];
k2=Kol[K[i][j+1]];
w2=Wiersz[K[i][j+1]];
line(k1,w1,k2,w2,"1px","black",aa);
}
}
draw();
}
</script>
</body>
</html>